% File name: report/report.tex

\begin{filecontents}{bibliography.bib}
@ONLINE {toastersmd,
    url= {http://openhardware.net/Misc_Stuff/ToasterSMD/},
    urldate = {2014-05-12},
    author = {Tom Walsh},
    title = {ToasterSMD}}
    
@ONLINE {hotplate,
	url = {http://www.hobbytronics.co.uk/hotplate-smd-soldering},
	urldate = {2014-05-12},
	author = {Hobbytronics},
	title= {Hotplate Surface Mount SMD Soldering Tutorial}}
	
@ONLINE {github,
	url = {https://github.com/JamesGlanville/pcb2gcode-metric},
	urldate = {2014-05-12},
	author = {James Glanville},
	title = {JamesGlanville / pcb2gcode-metric}}
	
@ONLINE {solderingmachine,
	url = {https://github.com/JamesGlanville/solderingmachine},
	urldate = {2014-05-27},
	author = {James Glanville},
	title = {JamesGlanville / solderingmachine}}
	
@ONLINE {imodela,
	url = {http://www.imodela.co.uk/},
	urldate = {2014-05-12},
	author = {TechSoft UK Limited},
	title = {iModela, the smart compact milling / engraving machine.}}
	
@ONLINE {caliperdata,
	url = {http://www.robotroom.com/Caliper-Digital-Data-Port.html},
	urldate = {2014-05-12},
	author = {David Cook},
	title = {Interfacing with Digital Calipers}}
	
@ONLINE {fpga4fun,
	url = {http://www.fpga4fun.com/SMD.html},
	urldate = {2014-05-12},
	author = {Jean P. Nicolle},
	title = {SMD (Surface Mount Device) / SMT (Surface Mount Technology)}}
	
@ONLINE {smdwiki,
	url = {http://en.wikipedia.org/wiki/Surface-mount_technology},
	urldate = {2014-05-12},
	author = {various},
	title = {Surface-mount technology}}
	
@ONLINE {excel2latex,
	url = {http://ericwood.org/excel2latex/},
	urldate = {2014-05-22},
	author = {Eric Wood},
	title = {excel =\textgreater LaTeX}}
	
@ONLINE {thingipaste,
	url = {http://www.thingiverse.com/thing:20733},
	urldate = {2014-05-22},
	author = {Richard Horne},
	title = {Universal Paste Extruder for 3d printers}}
	
@ONLINE {marlin,
	url = {https://github.com/ErikZalm/Marlin},
	urldate = {2014-05-26},
	author = {Eric Zalm},
	title = {Marlin 3d Printer Firmware}}
	
@ONLINE {dxf2gcode,
	url = {https://code.google.com/p/dxf2gcode/},
	urldate = {2014-05-26},
	author = {various},
	title = {dxf2gcode: A program to convert a dxf drawing into G-Code}}
	
@ONLINE {Cambam,
	url = {http://www.cambam.info/},
	urldate = {2014-05-26},
	author = {HexRay Ltd},
	title = {Cambam}}
\end{filecontents}

\documentclass[a4paper,11pt]{article}  % Standard document class
\usepackage[english]{babel}            % Set document language
\usepackage{fullpage}                  % Set up page for small margins etc
\usepackage{listings}
\usepackage{graphicx}                  % For including images in document

\usepackage{tikz}
\usetikzlibrary{shapes,arrows}

\usepackage{appendix}
\usepackage{color}
\usepackage{hyperref}

\usepackage{caption}
\usepackage{subcaption}

\usepackage{biblatex}
\addbibresource{bibliography.bib}

\usepackage[xindy,toc]{glossaries}
\makeglossaries

\newglossaryentry{GCODE}
{
	name=GCODE,
	description={A human-readable numerical control programming language, commonly used in CNC machines}
}

\newglossaryentry{PCB}
{
	name=PCB,
	description={Printed circuit board. A circuit board made of an insulating sheet covered in conductive traces to which components are soldered. FR-4 is the common grade
			of glass-reinforced epoxy used in most PCBs, and as such is the only material covered by this project.}
}

\newglossaryentry{SMD}
{
	name=SMD,
	description={Surface mount device. A component with no through-hole leads which is designed to be soldered to a PCB. In some cases the components are glued to the board
			for strength.}
}
\newglossaryentry{THT}
{
	name=THT,
	description = {Through-hole technology. An older technology (compared to SMD) where component leads are inserted into holes in a PCB. Still used in cases where the superior 
			attachment strength in required.}
}
\newglossaryentry{CNC}
{
	name=CNC,
	description = {Computer numerical control. Refers to the automation of machine tools with programmed commands.}
}
\newglossaryentry{ESC}
{
	name=ESC,
	description = {Electronic speed control. A device which controls a high-current motor from a logic input.}
}
\newglossaryentry{via}
{
	name=via,
	description = {An electrical connection between copper layers on a PCB. Usually in the form of a metal-plated through hole.}
}

%\usepackage{placeins}                  % Allows use of \FloatBarrier
% to avoid images or tables
% moving into next section
%\usepackage{subfig}                    % For subfigures...

\usepackage{amsmath}                   % For improving maths/formula typesetting
%\usepackage{tabular}                  % Table changing package

%\usepackage{algpseudocode}             % For producing algorithms/flowcharts

\usepackage{listings}                  % For including source code in document
\lstset{
	basicstyle=\ttfamily,
  basicstyle = \small
}

% Provide command for scientific notation
\providecommand{\e}[1]{\ensuremath{\times10^{#1}}}
\providecommand{\degrees}{\ensuremath{^{\circ}}}

% Define title here:
\title{4th Year Project: Automated soldering/solder paste machine (C-PJGL2-7)} %C-PJGL2-7
\author{James Glanville}
\date{11th June 2013}

\hypersetup{
    colorlinks,
    allcolors=blue,
    linktoc=all,
}

\begin{document}

% generate title
\maketitle

\begin{figure}[ht!]
\centering
\includegraphics[width=100mm]{resources/render.png}
\label{render}
\end{figure}

\newpage
\tableofcontents

\newpage

\section{Introduction}

\begin{figure}[ht!]
\centering
\includegraphics[width=120mm]{resources/smt_soldering.jpg}
\caption{Example surface mount board.}
\label{smdexample}
\end{figure}

The improvement in the electronics industry has led to a reduction in 
size of many components. Many components are now only available in
surface mount packages (see figure \ref{smdexample}). The surface mount 
devices (\gls{SMD}s) are designed to be soldered to \gls{PCB}s without
requiring holes to be drilled through the board. The combination of
smaller devices and no drill holes allow a much higher density of
devices to be placed on a PCB. This is both commercially
attractive and has facilitated dramatic reductions in the sizes of
electronic equipment. However, the use of such devices necessitates expensive 
equipment for assembly as the device placement tolerances are reduced.

In the prototyping and hobbyist markets, assembly is usually carried
out by hand, a process which requires significant time and skill. 
Automated systems (For example that shown in figure \ref{pickandplace}) cost upwards of \pounds 10k, which is cost-prohibitive
for the majority of users. 

\begin{figure}[ht!]
\centering
\includegraphics[width=70mm]{resources/pickandplace.jpg}
\caption{Juki KE2010L pick and place machine, approximately \pounds 50000.}
\label{pickandplace}
\end{figure}

The aim of this project is to develop ways to assist electronics 
hobbyists in working with SMD electronic components and circuit boards.
This must be achieved in a cost-effective way to ensure it is a viable
option. The use of complex or expensive tools (eg a lathe or mill) for
manufacture or assembly of the machine should not be required as not all
end-users have these facilities.

 
%\gls{SMD}s are electronic components which are designed to be soldered 
%to \gls{PCB}s without requiring holes to be drilled in the board. Compared to \gls{THT}(Through-hole technology), SMD parts 
%are usually smaller and cheaper and as a result are becoming ubiquitous in many applications. Even when hobbyist users do
%not require the size or cost advantages, many modern devices are only available in SMD packages. Using SMD parts require
%smaller board features (A manufacturing challenge) as well as more advanced soldering techniques. For this project, a machine
%is envisioned which solves some or all of the challenges involved to ease the process of SMD board development.




%\vspace{0.5cm}
As an example of the need for such a machine, see Figure \ref{usbisolator}. A USB isolator was required (to make USB connections to devices with non-isolated
power supplies), which uses an ADUM3160 SOIC-28 part (See full schematic, Figure \ref{usbisolatorschem}). Without an automated method of board manufacture, the
traces had to be hand drawn in etch-resist on each side of a double-sided board. Each component had to be carefully
placed with tweezers and then soldered. This was slow, and as figure \ref{usbisolator} shows, does not give
neat results.


\begin{figure}[ht!]
\centering
\includegraphics[width=150mm]{resources/SMDsizes.jpg}
\caption{Example SMD components (From \cite{fpga4fun})}
\label{overflow}
\end{figure}

\begin{figure}[ht!]
\centering
\includegraphics[width=120mm]{resources/usbisolator.jpg}
\caption{A USB isolator PCB with hand-drawn traces.}
\label{usbisolator}
\end{figure}

\begin{figure}[ht!]
\centering
\includegraphics[width=120mm]{resources/isolatorschem.png}
\caption{USB isolator schematic.}
\label{usbisolatorschem}
\end{figure}

\section{Project Concept}
The focus of this project is easing both the placement and the soldering
of SMDs. To this end a small machine was envisioned to automate the two
tasks. This would reduce the amount of time taken to populate PCBs, and
be of use to end-users who do not wish to carry out the manufacturing
process by hand. The envisioned end user of such a machine is a
hobbyist or academic user who wishes to produce small numbers of boards
with as little user time taken up as possible.


%\section{Project Idea}
%It was decided to approach the project by building a machine which can extrude solder paste accurately, and then place
%the surface mount devices on top. It should achieve this with minimal human interaction. The machine should also be able to
%drill holes for through-hole devices, as well as be equipped with a milling bit for isolation routing through copper-clad PCBs.

\subsection{Existing Solutions}
In order to identify potential improvements in manufacturing SMD boards
research was carried out in to the current methods used by hobbyists.
The methods were broadly divided into two categories: those using standard
solder in wire form and those using solder paste. %Solder paste consists of 
%powdered metal solder suspended in flux. It is used commercially to
%manufacture boards with SMD components, and used

\subsubsection{Methods using solder in wire form}
Despite the increased complexity, many SMD parts can be soldered by hand.
This is the lowest cost process which requires the least equipment: a
finer soldering iron tip may be all that is required. There are three 
main methodologies for this process:

\begin{itemize}
	\item	The pins are soldered individually. This is mainly suitable for larger SMD parts. A steady hand is required, as well as good eyesight.
			Binocular microscopes are often used to assist this process.
	\item	The process of "drag soldering" is used. The device is placed on the board, and a small amount of solder is placed on the tip of a soldering iron.
			The iron is slowly "dragged" along the pins. If done correctly, surface tension effects cause the majority of the solder to remain on the tip of the iron,
			while the necessary electrical connections are soldered.
	\item	The pins are roughly soldered, making sure each pin is at least soldered to the board. Many short circuits between adjacent pins will be present. Solder wick
			is then used with copious flux to remove excess solder between pins.
\end{itemize}

These methods are imprecise, and will often necessitate the use of solder wick or a solder sucker to remove solder bridges (See Figure \ref{handsolder}). More importantly, they are wholly unsuitable
for use with "leadless" packages. Instead of metal pins, these devices only have metal pads on their bases. Without exposed metal when the device is placed, it is not possible
to solder the connections by hand.

\begin{figure}[ht!]
\centering
\includegraphics[width=120mm]{resources/handsoldering.jpg}
\caption{Removing excess solder with solder wick.}
\label{handsolder}
\end{figure}

\subsubsection{Methods using solder paste}

Solder paste consists of powdered metal solder suspended in flux. It is used commercially to manufacture boards with SMD components. The solder paste is applied to the board where
connections are to be made. The devices are then placed on top (the paste has slight adhesive properties which limits undesirable component movement). Finally the paste is heated either directly
or indirectly which causes it to melt and form solder joints. The paste is placed in a number of ways:

\begin{itemize}
			\item	Solder stencils: A thin stencil is manufactured, usually from Mylar (trade name for BoPET) or stainless steel, with holes which correspond to locations on the board that require solder.
					This is used to screen print solder paste to the board.
%					Solder paste is then roughly applied to the top of the stencil before being scraped off. This forces controlled volumes of paste into the holes.
					This a very quick process, and suitable for production quantities, but has the expensive set-up costs of stencil manufacture.
			\item	Solder paste can be applied by hand using a syringe. However, this requires high accuracy while placing paste and is time consuming.
			\item	Automated solder paste extrusion uses a CNC (Computer Numerical Control) platform to manoeuvre a solder paste extruder around the board. Small amounts of paste
					are extruded where necessary. This is not the fastest method of manufacture, but is suitable when only small numbers of boards are required.
\end{itemize}

Once the solder paste has been placed and the devices placed on top, it must be heated to form solder connections. This can be achieved in several ways:

\begin{itemize}
			\item	A hot air gun can be used manually to locally heat the required areas of the board. Hot air guns are inexpensive, but the process requires care so as not to overheat any
					components. It can also be relatively difficult to get the correct temperature profile - some solder joints may be overheated while some may not fully form.
			\item	Entire board heating involves placing the board in an oven which is heated to the correct temperature. This can vary from large commercial equipment to the use of a
					converted toaster oven.
\end{itemize}
			
\subsection{Evaluation of project approach}
It was decided that automating the soldering of devices using solder wire
would prove too challenging, as the various methods all require a great
deal of feedback and error correction to correct poor connections or shorts.

%Therefore a method was required to place the solder paste in the correct
%places and the components on top of it.

The project approach was therefore to be a CNC machine which could both place the 
solder paste and the devices. This was to be achieved with minimal human
interaction. The solder paste would be placed by extruding it through
a sufficiently small needle that could be moved in three dimensions
compared to the board.
%It was decided to approach the project by building a machine which can extrude solder paste accurately, and then place
%the surface mount devices on top. It should achieve this with minimal human interaction. The machine should also be able to
%drill holes for through-hole devices, as well as be equipped with a milling bit for isolation routing through copper-clad PCBs.
%\parskip 0.18in

%When finished, the machine should be able to be connected to a computer via a USB port. A custom GUI will load the necessary 
%design files (for example the holes to be drilled, pads to be soldered), generate the necessary GCODE, and send it to the printer.

\subsection{Possible expansions of project scope}
Once the project concept had been chosen as a CNC machine with a syringe
tool and a placement tool it became clear that such a machine may be 
capable of manufacturing the PCB itself without a great increase in cost
or complexity if an extra spindle tool could be designed. This would
allow the use of a milling bit for isolation routing through copper-clad
PCBs, and a drilling bit to drill any holes for through-hole devices.

\subsection{Project specifications}


%\section{Requirements}

\subsubsection{Device placement}
\label{devplacement}
A device pitch (distance from centre of one pin to the next) of 0.4mm is typical of small SMDs. Using solder paste,
devices will shift slightly upon heating to self-align due to liquid solder's surface tension. A requirement is that the device should be placed to a
small fraction of its pitch, so there is no danger of incorrect connections. An accuracy of $\pm$ 0.05mm
in placement was chosen as a project goal. This should be sufficient to ensure the correct connections are made, but may be difficult to achieve in practice.

\subsubsection{Board size}
A maximum board size of 100x100mm would be sufficient for the vast majority of boards. 100x100mm was chosen because that
is the maximum board size using the free version of EAGLE, a popular design package. As a result, there are a lot of designs
that use the maximum size, and it would be useful if this project allowed those designs to be populated.
The PCBs needed for the IDP fit within the 100x100mm area, so this project
may be of use in the engineering department for IDP board manufacture.

\subsubsection{User interaction}
User interaction should be minimal. While this will not be an entirely 
automated process (for example the SMD parts may need to be manually loaded
into a tray) the less attended time required the better. All user
interfaces should be user-friendly, and all processes designed to reduce
the user's workload.




\section{Design}

The design of the machine is split into a number of subsystems that are
described in sections \ref{firstsection} through \ref{lastsection}. These
are:

\begin{itemize}
	\item Machine motion. A three-axis CNC subsystem is required to move
		the various tools in three dimensions relative to the PCB.
	\item Electronics. An electronic module is required which can drive
		both the machine's axes and the tools, while responding to user
		interaction.
	\item Solder paste extruder. This must be capable of accurately
		dispensing small volumes of solder paste.
	\item Device placement tool. This must be capable of picking up and
		placing the SMDs in their required locations.
	\item Spindle. This powers the milling and drilling bits to manufacture
		the PCB itself.
	\item Hot air tool. This heats the solder paste to reflow it and form connections.
\end{itemize}


%electronics, axes, paste, place, spindle

\section{Machine motion}
\label{firstsection}
This section describes the requirements for machine motion and how they 
are implemented in the design. There was the choice between moving the various tools over a stationary
bed, or keeping the tools stationary and moving the bed. For this project
only the bed will be moved, because it means that the pick
and place functionality does not have to move the parts, simply lift and lower them. This should reduce the risk of the parts
shifting on the needle, or falling off.% It also allows for the use of more tools since weight is no longer a concern. 

\subsection{Requirements}
The axes all have the same requirements of $\pm$ 0.05mm accuracy (as 
described in section \ref{devplacement}). The greatest forces are
encountered during the isolation routing operations, which were
measured to be less than 2N. The system accuracy must be maintained
under this condition.

The Z axis has the smallest required travel distance as the tools
need only move high enough to clear any devices. A minimum travel of 50mm
was chosen which is more than sufficient for the tallest devices. The
X and Y axes must not only be capable of moving over the maximum 100x100mm
board, they must also allow travel to where the devices are stored prior
to final placement. A total area of 100x130mm was chosen as a compromise
between maximum device storage and total machine size.

A major design philosophy was to be that all of the axes should be as
similar as possible. This would result in the least amount of development
work possible, as well as the most similar axis characteristics. This 
was later important during testing so it was not necessary to separately
characterise the errors of each axis.

For the machine to be practical, there are some limitations on the 
maximum time that a board can take to manufacture. This is particularly 
true of the device placement stage, as this requires
human intervention. The total time is dominated by the time taken by axis
movement so the axis speed should be as high as possible to compensate.

%\begin{itemize}%
%	\item	X/Y travel.
	%\item	X/Y cutting.
	%\item	Z movement.
	%%\item	Picking/placing components.
%	\item	Hot air reflow.
%\end{itemize}

%The X/Y travel will take the most time in total, so the estimated times should be calculated and optimised if possible. Assuming a travel speed of 10mm/s, the total
%time is simply total distance (mm) / 10.





%
%\subsection{Z axis}
%The Z axis requires the same precision as the X and Y (Isolation routing bits are conical, therefore trace width error is proportional to height error). 
%
%\subsubsection{Potential mechanisms}

%\begin{itemize}
%	\item	Hinged Z using micro servos: cheap (\pounds 2 on eBay). Require no drivers, and simple to drive. Z axis potentially
%		does not need to be linear so rotary-\textgreater linear mechanism simpler. If not linear,
%		then hinging out of the way is a cheaper mechanism than slides.
%	\item	Using an identical threaded rod mechanism to the X and Y axes. This has the advantage of requiring less design work.
%\end{itemize}

%\subsubsection{Chosen design}
%The same mechanism (threaded rod and stepper motors) was chosen for the Z axis. Ideally the axes will be as similar as possible which will result
%in less work characterising the errors in the mechanisms.

%



%\subsection{X/Y axes}
%\subsection{Rigidity}
%The sideways forces generated by the isolation routing bits were measured to be less than 2N. It is important that the $\pm$ 0.05mm
%accuracy requirement is met under this condition.

%The X/Y axes have the same requirements: $\pm$ 0.05mm accuracy.



%The bed will need travel distances of at least 100mm in both directions so that the entire bed can be accessed by tools. However,
%there should also be space to place devices before they are automatically placed. An area 

\subsection{Design selection}
Two possible drive methods were considered for use in this project:
\begin{itemize}
	\item	Stepper motors: These are brushless motors which can be controlled down to the nearest "step" (commonly 1.8\textsuperscript{0}). They require
			stepper motor drivers to provide the alternating magnetic field. Provided the maximum torque is not exceeded, they can be run open-loop.
	\item	DC motors + feedback: A feedback mechanism such as a rotational encoder or linear potentiometer can be used to provide feedback for closed-
			loop control of DC motors. A microcontroller adjusts the current to the motor accounting for its current position and desired position.
\end{itemize}
Stepper motors were chosen as they facilitate a simple implementation.
Coupled to the drive mechanism, they are driven open-loop under the
assumption they will rotate precisely proportional to the number of 
electrical pulses. Their extra cost compared to DC motors is offset
by the simpler design and lack of feedback elements to consider. They
also have the advantage that they can easily be controlled by existing
electronic module firmware (see section \ref{firmwarestuff}). The type
of motor was chosen to be a type of NEMA17 (standard motor size) motor
with a 2.2kg/cm holding torque. This was found to be sufficient for an 
axis speed of 10mm/s without any skipping of steps.
%Having chosen to use small stepper motors to control the axes, the choice of stepper motor is now important. Some NEMA17 motors were tested,
% which claim a 2.2Kg/cm holding torque. Tests were run to see what their maximum
%speed without skipping steps was, with a result of 10mm/s. This is sufficient for use in the
%project (where speed is not a great concern), but it was thought that it would not be beneficial to use a smaller motor. 


A number of methods are available to translate the rotational driving
 motion to the linear motion required for the axes. Those
considered for this project are as follows:

\begin{itemize}
	\item	Toothed belts and pulleys: These are simple and inexpensive. However, despite the fibreglass or steel strengthening cables, they will
			still elongate under load. As a result, they are not suitable for any routing/milling operations.
	\item	Threaded rod and ordinary nuts: This is an inexpensive solution that relies on the threaded rod having a constant pitch. Strong springs 
			are added between each pair of nuts to provide an anti-backlash effect.
	\item	Ball screws: These are similar in operation to threaded rod and ordinary nuts, but use ball bearings between the nut and rod for smoother
			operation. These are sprung against the rod for an anti-backlash effects. They are higher performance, but more expensive.
\end{itemize}
Threaded rod and ordinary nuts were chosen for use in this project because
of their low cost compared to ball screws, and their strength compared
to toothed belts. A thread size of M8 was chosen as it provided sufficient
accuracy at a high enough speed.

The axes are required to move the bed in three dimensions. However the 
threaded rod is only capable of providing accurate motion if the bed
is constrained to move only in the axis direction. To this end a slide
mechanism is required. Three such mechanisms were considered:

\begin{itemize}
	\item	Drawer slides: Inexpensive drawer slides contain pre-loaded ball bearings which reduce wobble.
	\item	3d printed bushings and steel rod: If 3d printer existence assumed, then very cheap solution. These bearings
			will wear over time, so replacement must be trivial.
	\item	LM8UUs and steel rod: About 50p each, simple to use and accurate.
\end{itemize}

Drawer slides were chosen because of their cost advantages as well as the fact
they can easily be coupled to flat boards.


\subsection{Zeroing the axes}

When the machine is used it is necessary to "zero" the axes to a known datum point on the board. This is particularly important when swapping tools, as there may
be a small variation in tool location compared to toolholder location between tools.

\subsubsection{X and Y axes}

In order to zero the machine in the X and Y directions, an "L-shaped" piece of metal has been added to the bed (insert pictures/diagrams). All of the tools are metal,
and therefore conductive. The axes are first manually moved to be near-zero. The tips of the tools are all electrically connected to an input pin on the AVR, with a weak (10K) internal pullup to 5V.
The "L-shaped" piece of metal is connected to ground. When instructed, the firmware slowly moves the X or Y axis in the negative direction until a contact is made, and the input goes LOW. At this point,
the exact position of the tool is known. For convenience it is important that the location of the centre of the tool is known, this can simply be calculated as the diameters of all of the tools are known and fixed.

\subsubsection{Z axis}

Slightly different mechanisms are used for the zeroing of the Z axis when used for different tools. 
For the vacuum needle, a small microswitch is placed above the needle while is free to move 
slightly in the vertical direction. It is triggered when the needle is touching either the bed or the top of a component. As a result, zeroing can be carried out simply by 
moving the tool downwards until it is triggered.
The other tools are zeroing electrically using the same mechanism as for the X and Y axes. The tools are lowered until contact is made between the PCB and the tool. A temporary contact must be made from ground
to the copper pcb, this is achieved with an alligator clip.

%\subsubsection{Chosen design}

%M8 threaded rod was chosen as the linear actuators, coupled to stepper motors. This simplifies control compared to a closed-loop solution, and is readily
%supported by existing microcontroller firmware. Drawer slides will be used because they are the cheapest option, and are easy to mount to flat boards.

\section{Electronics}
The electronics subsystem must be capable of driving the machine's axes
and tools, carry out the required commands for PCB manufacture, and 
respond to the user's input and provide feedback. This section includes
the firmware which will run on the electronics system. 

\subsection{Specification}
The stepper motors used in the project are rated to a maximum of 2.5A
drive current which must be provided by the electronics. 

The machine should ideally be capable of standalone operation (i.e. without
an attached PC). This allows the machine to operate at a further distance
from the user which would alleviate concerns about noise and dust.
This will require the use of some form of storage for
the manufacturing commands.

The spindle motor is a brushless motor with a maximum current draw of 20A.
This requires a controller to provide the necessary switching signals.

The PC interface should be compatible with all major operating systems.

\subsection{Power Supply}
The operating voltage of the stepper motor drivers and the spindle motor
is 12V. Assuming the current draw from the electronics is small, the 
peak current can be calculated to be 27.5A (20A for the spindle, 2.5A for each axis).
In practice the average current will be far lower as the spindle draws 
a much smaller current when not accelerating. A 12V 30A power supply was
chosen to power the machine. It has over-current and overheating protection built in, but as a failsafe, a 30A fuse is added in-line with the +12V cable. 
An automotive-style fuse was used for the lowest cost, and ready availability of suitable fuse ratings.

\subsection{Stepper motor drivers}
Stepper motor drivers are required to translate between logic-level
motion commands and the high current pulses required to drive the stepper
motors. This type of drive is frequently required in commercial products
such as printers, scanners and automated machinery and as a result a 
great number of suitable ICs are available.

For this project Toshiba TB6560AHQ drivers were selected as the lowest
cost part with sufficient drive current. These need only two input
signals from the electronics module, \textbf{step} and \textbf{direction}
and provide the necessary control to the motor. They require minimal 
support circuitry, merely decoupling capacitors and current sensing resistors.

\subsection{PC interface}
For simplicity, the communication between the PC and the electronics board is implemented as a serial link. An arbitrary baud rate of 57600 has been
chosen, this is sufficiently fast so that the electronics board is not slowed by waiting for instructions (as the firmware buffers incoming commands in
a small buffer in RAM), and sufficiently slow that the error rate is assumed to be zero. The operating voltage of the microcontroller is 5V, so the
serial link is not RS232-compliant. Instead either a USB-\textgreater serial cable or a bluetooth module is required:

\subsubsection{USB-serial cable}
A USB to serial cable based on the FTDI FT232R chipset can be plugged into the serial header on the electronics board. This is a cheap (\textless \pounds 5) device that is 
a complete solution. Driver support for the FT232R is available for all platforms that have been considered (Windows/OS X/Linux/Android). A usb serial cable
was chosen instead of an integrated chip because it allows more flexibility for using other interfaces instead. For example, a real RS232 port may be used with a trivial
MAX232 level shifter.

\subsubsection{Bluetooth link}
A bluetooth module can be installed to provide wireless communication which may be more convenient. The HC-05 bluetooth module was
chosen because of its low cost (\pounds 3.50) and simplicity. The board requires a 3.3V supply, which is not present on the electronics board. A small
breakout board was manufactured for the module, including an AMS1117-3.3 3.3V linear regulator (\pounds 0.10) and link status LEDs. The 3.3V TX output from the module is sufficient
for the AVR despite its higher 5V supply. To avoid damage to the bluetooth module, a potential divider consisting of two 1k resistors is used. This 2.5V output is
again sufficient for the bluetooth module.

To configure the baud rate for the bluetooth module, it was connected to a pc using a USB-serial cable. The bluetooth module is powered up whilst the "KEY" pin is held high (3.3V).
This starts the module in AT configuration mode. The baud rate was then set by sending the string "AT+UART=57600,1,0" at 38400 baud. This configuration is only required once,
the module stores all configuration in non-volatile storage.

\subsection{Microcontroller and firmware}
The electronics subsystem requires a microcontroller running firmware
that can translate incoming commands from the serial port into commands
to the three axes and the various tools. 

An Atmel ATmega1284P chip was chosen as the controller for the following reasons:

\begin{itemize} \itemsep0em
	\item	It has sufficient pins to drive all of the stepper motors, tools and user interface.
	\item	It is capable of running at the 5V logic voltage of the stepper motor drivers.
	\item	It is a common choice for running CNC tools, and as a result a great deal
			of existing firmware is available to hasten development.
%	Cost: an atmega328 is \pounds 2-3, a USB-serial chip is \textless \pounds 2, which is not much.
%	\item	Mature open source firmware (GRBL, https://github.com/grbl/grbl) is available for GCODE-\textgreater stepper
%		conversion, which leaves more time to focus on other parts of this project.
\end{itemize}

%\section{Standalone Operation}
%It may be useful to operate the machine without a connected PC. In the case of manufacturing a large number of boards, it may be impractical to dedicate a PC simply to sending GCODE.
%In addition, some functions of the machine produce dust, and are noisy. Allowing the machine to operate in a more remote location could be convenient. 


\subsection{Command storage}
In standalone mode the required commands must be stored on the machine. 
SD cards are ideal for use with microcontrollers, as they have a simple protocol 
(SPI), and are inexpensive. They also have wide compatibility with other devices. It would be useful if 
the GCODE could be stored on an SD card and read by the machine.

SD cards can operate in SPI mode, using only four connections (MISO, MOSI, CLK, CS). However, they operate at 3.3V, and the AVR operates at 5V. To power the card, an AMS1117-3.3 linear regulator
is used. Level translation must be used to convert the four connections to the required voltages. There are three options for this process:

\begin{itemize} \itemsep0em
	\item	Potential dividers. This is the simplest option, using only resistors. The CS, MOSI and CLK connections send data to the SD card. A potential divider is used to reduce the voltages
			from 5V to 3.3V. The MISO connection receives data from the SD card. The AVR has a high input threshold of above 2.6V. MISO can therefore be connected as it operates up to 3.3V. 
			Although this is the simplest option, the high impedance output from the potential divider can cause problems at fast SPI speeds, as the SD card presents a relatively high
			capacitive loading.
	\item	Discrete transistors can be used to translate between 3.3V and 5V. This has the advantage of faster operation, and increasing the noise margins (reduced when using 3.3V with a 5V chip).
			Two transistors are needed for each connection to ensure the signal is not inverted.
	\item	A level translation IC can be used. This needs no additional components (except from a decoupling capacitor).
\end{itemize}
Here a level translation IC was chosen.


\subsection{Firmware}
\label{firmwarestuff}
The microcontroller requires firmware which can fulfil all of the subsystem
requirements. Usefully such firmware already exists to drive 3d printers
and other CNC machines, so this could be used without significant
modification. The "Marlin" firmware (\cite{marlin}) was chosen as it readily supports
operation from SD cards, as well as an LCD interface.

\subsection{LCD and user interface}
\label{lcdUI}

\begin{figure}[ht!]
\centering
\includegraphics[width=70mm]{resources/lcd_real.jpg}
\caption{LCD user interface.}
\label{lcdreal}
\end{figure}

If the machine is to be used in a standalone capacity, there must be a way for the user to choose which GCODE file to send.
Figure (~\ref{lcdreal}) shows the machine's user interface.

\subsubsection{Hardware}
A 4x20 LCD is used to display information about the current job, as well as allow the user to select GCODE files. This is an inexpensive part based on the ubiquitous HD44780 controller chip.
It is operated in 4-bit mode (as opposed to 8-bit mode, which requires four additional microcontroller pins). Six connections are required to the microcontroller: RS, EN, D4, D5, D6, D7. As
the electronics board does not have many spare connections, it was decided to use an MCP23017 i2c port expander to connect the LCD. The Marlin firmware already supports this, and needs just
two connections (SDA and SCL) to the driver board. See Figure ~\ref{lcd_backpack} for the schematic.

\begin{figure}[ht!]
\centering
\includegraphics[width=160mm]{resources/lcd_backpack.png}
\caption{Schematic of i2c -\textgreater LCD board.}
\label{lcd_backpack}
\end{figure}

A rotary encoder is used to provide input. This uses quadrature outputs to determine motion. The encoder also has a push switch inside for selecting options. This therefore require three microcontroller
pins in total.










\section{Solder paste extruder}
The solder paste extruder is a tool which dispenses controlled volumes
of solder paste on to the board. 

\begin{figure}[ht!]
\centering
\includegraphics[width=70mm]{resources/pasteextrusion.png}
\caption{Paste extruder shown extruding required paste for a TSSOP16 chip.}
\label{pasteextrusion}
\end{figure}


\subsection{Requirements}
The tool must be capable of accurately extruding very small volumes of 
solder paste. As an example, a 0.4x0.2mm pad to be coated with a thickness
of 0.4mm of paste requires just 32nl of paste.

Solder paste deteriorates in contact with the air. It is supplied in
syringes from which it should be directly extruded, avoiding transfer
to other containers.

The tool must not extrude in places it is not required to, i.e. dribble.
The pressure applied to the syringe must therefore be rapidly released at the end
of extrusion.

\subsection{Initial tool}

Initially, a freely available design for the paste extruder was used \cite{thingipaste}.

The extruder works by applying pressure to the top of the solder paste syringe. Pressure is applied by tightening a pulley made
of T5 timing belt with a geared stepper motor. This design was chosen because the extruder is compact, and the design allows for
fast reduction of pressure, important for clean extrusion and to avoid the solder paste dribbling. 

To calibrate the extruder, two parameters are needed: steps/volume extruded and retraction steps. The first is easy to calculate:

(All dimensions in mm,mm\textsuperscript{2},mm\textsuperscript{3})

The solder paste is supplied in a 2.5ml syringe, with a 66.1276mm\textsuperscript{2} cross-sectional area.

\begin{eqnarray}
\text{Volume extruded / step} &=& \frac{\text{cross-sectional area of syringe} \times \text{T5 pitch} \times \text{number of teeth of T5 pulley}}{\text{number of microsteps} \times \text{steps/revolution} \times \text{gear reduction ratio}} \nonumber \\
&=&\frac{66.1276 \times 5 \times 10}{16 \times 200 \times 12} \nonumber \\
&=&0.0861mm\textsuperscript{3} \nonumber \\
	\text{Steps / mm\textsuperscript{3}} &=& \frac{1} {\text{volume extruded / step}} \nonumber \\
	&=& \frac{1}{ 0.0861} \nonumber \\
	&=& 11.61 \nonumber
\end{eqnarray}

The retraction steps must be experimentally determined. The choice is a trade-off between minimising solder paste dribble (large number
of retraction steps) and reducing total process time (small number of retraction steps). It must be enough that negligible pressure is
exerted on the syringe when retracted.

Some method to "prime" the extruder will be needed. Assuming the extruder is initially hand-tightened so that the belt has little slack,
a possible method is to repeatedly advance the extruder and then retract by a slightly smaller amount, until the user notifies the machine
that solder paste has been extruded. At this point, the extruder should pause after retracting. The solder paste deposition process can
then commence since the exact point of extrusion has been established. 

\subsection{Design improvements}
The solder paste extruder design that was initially used was unnecessarily bulky and complex. This made it both harder to fit to the tool mounting mechanism, and increased the
distance between the mount and the tool, amplifying any wobble in the mount. It was therefore deemed necessary to redesign it, optimising for size. Operation and performance
is similar between all designs however.

\subsubsection{Paste extruder using bevel gears}
\begin{figure}[ht!]
\centering
\includegraphics[width=170mm]{resources/extruders.png}
\caption{Extruder from drawing to render to 3d printed item.}
\label{overflow}
\end{figure}

The first attempt to reduce the size of the extruder used bevel gears to shrink the size of the gearbox. 

Worm gears would give the same gear ratio in a smaller gearbox, so a new design was made using them. The improved design is as small as possible and performs as well as the much larger extruder that
was originally used. See figure (~\ref{wormextruder}) for a rendering.

\begin{figure}[ht!]
\centering
\includegraphics[width=90mm]{resources/worm.png}
\caption{Extruder using worm gearing.}
\label{wormextruder}
\end{figure}



\section{Device placement tool}
In order to precisely place the SMDs on to the board, a tool is required
which can lift them from a known location and deposit them where necessary.

\subsection{Requirements}
The components must be placed to the specified $\pm$ 0.05mm.

\subsection{Design}
A vacuum pump was chosen to power a fine hollow needle. The needle
is placed over an SMD, and the vacuum pump switched on. The device
is then "stuck" to the needle, which can be then lifted and moved to
the correct position. Once there, the pump is switched off and the
device will remain stuck to the solder paste in position. This is an
inexpensive solution, and also that used by commercial pick and place
machines.

As each component has a different height, a microswitch is used above
the needle to detect component physical contact to the needle. At this
point the vacuum pump can be switched on.

A power MOSFET is used to control the pump, with a reverse-biased
diode to suppress back-EMF. The MOSFET was chosen to have a small V$_{GS}$
so that it could be fully switched on by the 5V microcontroller output.


\subsection{Managing devices prior to placement}
There was a need to be able to place the devices in a known position, so they can then be picked up and placed in their final locations.
Commercial pick and place machines take the parts directly from the reels they are supplied in. While this is optimal for that application in that
it is fast, the cost of reel dispensers is prohibitive for this machine. Instead, the parts will have to be roughly placed
by hand. There are a number of ways this could be done:

\begin{itemize} \itemsep0em
	\item	Embossed outlines of all necessary device footprints.
	\item	Rectangular embossed outline, devices to be located in one corner.
\end{itemize}

It was decided that the former would be simplest to implement. A
brass plate was milled to have indentations to suit a variety of SMD
footprints. The parts are placed into the indentations by the user
when required.

PCB CAD programs are able to export a list of components along with their
physical locations on the board. Kicad supports this by exporting a \textbf{.pos}
file in human-readable format. Pcb2gcode has been modified (see \textbf{pnp.cpp}
and \textbf{pnp.hpp}) to parse this file and extract the necessary data.
From this, the appropriate indentation in the component plate can be 
chosen based on the device package type. The user is informed of where
to place the device, and the machine can then pick it up and place in onto
the board.

\subsection{Prototype}
To test how effectively small parts could be placed with a vacuum, a simple test setup was fabricated:

\begin{itemize} \itemsep0em
	\item	12V diaphragm air pump (\pounds 8.89 - eBay)
	\item	6mm OD/4mm ID silicone tube (\pounds 2.69/m - eBay)
	\item	various needles (need more info here)
	\item	MOSFET
	\item	330$\Omega$ resistor
\end{itemize}

\begin{figure}[ht!]
\centering
\includegraphics[width=90mm]{resources/pump_and_hose.jpg}
\caption{Pump with hose and needle.}
\label{hose and needle}
\end{figure}

The pump draws ~200mA at 12V, which is easily controlled with a MOSFET. Using a 1.8mm ID needle, SOIC-20 parts were picked up, 
and had significant friction against the needle - essential to avoid slipping or rotating. It was important to place the needle 
as centrally as possible on the part to avoid generating any imbalance that allowed the part to fall. 

\subsection{Conclusions}
A vacuum needle solution is workable, and a good choice for this project. Things that need to be considered for use in the final project:

\begin{itemize}
	\item	The pump takes a certain time to generate a vacuum because of the relatively large internal volume of the pump
		and silicon tube. It will be important to measure this, and add a margin of error so that full suction is applied
		to each device before any movement takes place. Similarly, when turning off the pump, the pressure must return to
		atmospheric before the device can be considered to have been placed successfully. In testing, the pump took
		less than a second to leak sufficiently for this to occur, but if another pump were to be used, it may be necessary
		to place a tiny hole in the air line so that pressure drops quickly.
	\item	It is important to place the needle very near to the centre of mass of the device. The majority of devices will be
		symmetrical, which will make this easier.
	\item	The needle must be able to be raised and lowered to the correct heights. It may be possible to push the needle down
		with a weak spring, with a micro servo that raises it - this would remove any need to know the exact height of each
		device. This will need to be tested.
\end{itemize}

\begin{figure}[ht!]
\centering
\includegraphics[width=90mm]{resources/needle_with_resistor.jpg}
\caption{SMD resistor being picked up.}
\label{overflow}
\end{figure}


\section{Spindle}
The spindle is used for isolating routing, milling and drilling operations.

Isolation routing is a method to mill traces from copper-clad pcb. A conical engraving bit is used to cut very narrow tracks through
the copper, to leave disconnected pads as required. Figures \ref{breakout} and \ref{breakout_closeup} show a small SOIC breakout board that has been isolation routed using the machine. 


Milling operations would be useful to cut the final PCB to size and to
cut out any larger interior holes. While not the central focus of this
project, the use of the machine to perform light milling operations
would be significantly useful for many users.

Drilling holes in pcbs is a time-consuming process to do by hand. It can also be difficult to locate the holes precisely, which can be a problem
for holes for small \gls{via}s, or when holes must be aligned exactly (for example to fit a row of header pins). If this machine could drill the holes automatically,
it would reduce the total time taken significantly.

\subsection{Requirements}
When isolation routing, the fine tip of the bit has very small flutes. As a result it can only manage
small chip loads (the amount of material cut by each pass of a flute). To cut in reasonable time, a high speed spindle is required - up to 40000rpm.

The bits experience significant sideways forces (Approximately 2N when isolation routing, and 10N when milling). The spindle
should have minimal runout under these conditions.

\subsection{Design}
A small brushless motor is ideal for such a spindle. The hobbyist radio
controlled aircraft market provides low cost, high speed brushless motors
along with the necessary speed controllers. A 25 Amp \gls{ESC} 
(Turnigy plush 25A, \pounds 9) powering a small brushless motor 
(Turnigy 2217 20turn 860kv 22A outrunner, \pounds 10) is capable of milling
steel (in the author's experience), so smaller, cheaper motors should be 
capable of routing/drilling copper. For this project a 3800KV motor was
chosen for a maximum unloaded spindle speed of 45600rpm. In practice the
achieveable speed will be lower due to losses in the ESC, as well as load
from the cutting operations.

The biggest design challenge was to mechanically couple the motor to the
required bit. There is almost zero allowance for axial misalignment, as 
the fine bits are liable to shatter otherwise.

An alternative design would be to use a low cost rotary tool, which already has the bearings, collet and spindle motor. 
However this approach would likely be too bulky, and many rotary tools
do not have sufficiently low runout for use with fine bits.

\subsection{Prior art}
Many CNC mills use a collet to hold the bits. This is tightened
around the bit, holding it in place with friction. The problem with this
application is that using a collet system would require custom metal work,
something not necessarily available to the envisioned end user.

The iModela cnc (\cite{imodela}) is an example of an inexpensive desktop
CNC mill. This uses a small ball bearing for the shaft, with custom machined shafts. The milling bits fit inside the shaft, and
are secured with a single grub screw. This seems to work, though it would need a very carefully machined shaft so that axial misalignment
did not shear the end of the milling bit, particularly with the very
fine tools in use for this project.

\subsection{Chosen design}
A novel design was tested for the spindle. Instead of securing
the bit in a collet surrounded by a ball bearing, the bit would 
surrounded by a number of ball bearings, sprung to provide a strong clamping
force against the bit. The rotational coupling was achieved with
a thick elastic O-ring, which allowed for the motor to be misaligned
whilst still transferring rotation to the bit. In testing this performed
excellently, and was capable of routing fine tracks without measureable runout.

\subsection{Improvements}

\begin{figure}[ht!]
\centering
\includegraphics[width=90mm]{resources/spindle.png}
\caption{Rendering of improved spindle design}
\label{spindle}
\end{figure}

The spindle was redesigned to be stronger and neater. See figure (~\ref{spindle}) for a rendering.
The new design encloses the moving parts more for safety.

\subsection{Milling}
There are a number of uses for a machine capable of light milling:

\begin{itemize} \itemsep0em
	\item	Manufacturing PCBs with arbitrary shapes. For example, It is possible to build connectors from PCBs that lie on the circuit board if they can be milled to the correct shape.
			For example, USB connectors. This reduces part cost.
	\item	Improving the finish of 3d printed components. In cases where the rough edges of 3d printed parts are not satisfactory, a milling pass over the piece can increase the flatness
			of edges.
	
\end{itemize}

The spindle on the machine is quite capable of light milling, with some limitations:

\begin{itemize} \itemsep0em
	\item	Milling bits only protrude from the spindle by approximately 8mm (depending on the bit). This means that this is the deepest cut the machine is capable of making.
	\item	The axes do not have the rigidity required for milling tough materials. Plastics and wood are possible, while metals are not.
	\item	The spindle only supports parts with a 3mm shank.
	\item	The spindle speed is variable from 1000-\textgreater40000rpm unloaded. The speed controller attempts to maintain the rotational speed setpoint, however it prioritises
			correct motor commutation. Therefore at higher speeds under heavy loads care must be taken that the spindle speed does not drop significantly. In practice this is unlikely
			to be a problem, as the motor has a maximum power of 250W and has significant moment of inertia.
\end{itemize}

As this functionality is not a central focus of this project, only a simple demonstration of milling ability was carried out. The spur gear used in the gear extruder is cut from 6mm acrylic:

\subsubsection {Gear CAD}
The Creo design was exported as a .DXF file. The closed source program Cambam (\cite{Cambam}) was used to generate
GCODE for milling due to the author's familiarity with the software, but many open-source alternatives are available
(eg dxf2gcode \cite{dxf2gcode}).

\subsubsection {Milling Settings}

The following settings were used to mill the green acrylic gear (Figure ~\ref{fig:gearcomparison}):

\begin{center}
	\begin{tabular}{| l | l | p{8cm} |}
	\hline
	Setting & Value & Comments \\ \hline
	Sheet material & 3mm green acrylic & \\ \hline
	Cutting bit & 1mm diameter endmill & Cambam estimated maximum endmill size to be ~1.4mm diameter. \\ \hline
	%conventional milling
	Depth increment & 1mm & Chosen to produce part quickly at the expense of edge quality. \\ \hline
%	12mm clearance plane
	Cut feedrate & 70mm/min & Very slow feedrate chosen for initial tests. \\ \hline
	Plunge feedrate & 70mm/min & Slow feedrate to avoid chips clogging.\\
	\hline
	\end{tabular}
\end{center}

\begin{figure}[ht!]
\centering
\includegraphics[width=90mm]{resources/gear_cambam.png}
\caption{Gear outline shown in red. Toolpath shown in green/blue.}
\label{overflow}
\end{figure}

\begin{figure}[ht!]
\centering
\includegraphics[width=90mm]{resources/gear_comparison.jpg}
\caption{Milled gear (left) compared to original gear (right).}
\label{fig:gearcomparison}
\end{figure}


\begin{figure}
\centering
\begin{minipage}{.5\textwidth}
	\centering
	\includegraphics[width=70mm]{resources/breakout.png}
	\captionof{figure}{Isolation routed SOIC board.}
	\label{breakout}
\end{minipage}%
\hfill
\begin{minipage}{.5\textwidth}
	\centering
	\includegraphics[width=70mm]{resources/breakout_closeup.png}
	\captionof{figure}{Closeup of breakout board.}
	\label{breakout_closeup}
\end{minipage}%
\end{figure}




\section{Hot air tool}
\label{lastsection}
Once the board has been pasted and the parts deposited, the solder paste needs to be heated up so that it will melt and form good connections.
There are a few possibilities for this process:

\begin{itemize} %\itemsep0em
	\item	Oven: a small oven can be used to heat the entire board (see: ToasterSMD \cite{toastersmd}, Figure \ref{toasteroven}). This appears to
			work well, however the oven should not be used for food after that, since the components of solder paste are toxic. As a result,
			it can be an expensive method since it requires dedicated, expensive hardware.
	\item	Hand-held hot air gun: A small hot air gun can be used to gradually melt the solder for the components (Figure \ref{hotairdemo}). There is a requirement
			for the hot air gun that it emits sufficiently hot air at a sufficiently low velocity that the solder will melt, but also that
			the devices will not shift under the force. 
			This does require the most human interaction (since it is less likely that the flow of hot air will cover the board uniformly, but it
			is not a particularly demanding process.
	\item	Hot-plate. A small hot-plate can be used to heat the board from underneath (see Hotplate tutorial \cite{hotplate}, \ref{hotplate}).
			An advantage compared to the oven method is that a piece of thermally conductive metal can be used between a hotplate and the board, so
			that the hot plate will not become food-unsafe. 
\end{itemize}
		
\begin{figure}
\centering
\begin{minipage}{.3\textwidth}
	\centering
	\includegraphics[width=40mm]{resources/boardintheoven.jpg}
	\captionof{figure}{SMD board being reflowed in a toasted oven.}
	\label{toasteroven}
\end{minipage}%
\hfill
\begin{minipage}{.3\textwidth}
	\centering
	\includegraphics[width=40mm]{resources/hotair_demo.jpg}
	\captionof{figure}{SMD component being soldered with a hand-held hot air gun.}
	\label{hotairdemo}
\end{minipage}%
\hfill
\begin{minipage}{.3\textwidth}
	\centering
	\includegraphics[width=40mm]{resources/hotplate.jpg}
	\captionof{figure}{SMD board being soldered with a hotplate.}
	\label{hotplate}
\end{minipage}
\end{figure}	
			
The choice of method to heat the solder paste may well depend on the end-user - one solution is not clearly superior to the others. During the
course of this project the hand-held hot air gun will be used most often due to equipment availability. It would however
be useful if this aspect of board manufacture could also be automated.
A hot air tool has been designed that travels over the board, reflowing
all of the connections.

\subsection{Requirements}
A hot air tool used for soldering has the following requirements:

\begin{itemize} \itemsep0em
	\item	Ability to heat solder paste up to $240\,^{\circ}\mathrm{C}$
	\item	Slow, steady airflow
	\item	Controllable temperature (i.e. not open-loop)
\end{itemize}

\begin{figure}[ht!]
\centering
\includegraphics[width=90mm]{resources/hotair.png}
\caption{Simplified diagram of hot air tool.}
\label{overflow}
\end{figure}

\subsection{Calculations}

Refer to Appendix \ref{heatcalc} for the heater calculations.

\section{Host computer software}
Software will have to be written to translate board cad data to gcode. Some of this already exists in the public domain, some will have to be made
as part of this project.

Isolation milling and drilling: pcb2gcode (https://github.com/festlv/pcb2gcode-metric). Takes gerber designs and generates isolation routing/drilling
GCODE. It is also capable of voronai isolation (functionally equivalent routing that cuts the least amount of material). The only configuration
will be to generate a millproject file with the correct cutting depths.

Solder paste placement: No freely available software.

Device placement: No freely available software.

The solder paste placement should be relatively straightforward. The program will simply need to find the locations of the pads, calculate their
area, and then apply a suitable amount of paste to them. For ICs, the paste will not need to be separately applied to each pin (due to the high
surface tension of molten solder), so some method of detecting ICs on the board layout will be needed.

The code to place devices will be the most challenging. However, provided there is a sensible area in which to hand-deposit the devices, it should
not be too hard to calculate how to transport them to the required location.

In my opinion, the most challenging part of writing the conversion code will simply be to extract the necessary data from the cad files. Once this
has been obtained, the GCODE should be easy to create.

\subsection{Improvements to pcb2gcode}
pcb2gcode was forked on github, and the improvements from this project are available at \cite{github}.
To demonstrate the effects of the improvements, pictures of a SOIC-20 breakout board being processed are included (Figures ~\ref{pcb2gcodeinput} , ~\ref{pcb2gcodeisolation} , ~\ref{pcb2gcodepaste} ).

\begin{figure}[ht!]
\centering
\includegraphics[width=90mm]{resources/breakout_copper.png}
\caption{Input to pcb2gcode, showing the copper traces in white.}
\label{pcb2gcodeinput}
\end{figure}

\begin{figure}[ht!]
\centering
\includegraphics[width=90mm]{resources/breakout_isolation.png}
\caption{Output from pcb2gcode, showing isolation routing pattern (milling to be run between coloured sections).}
\label{pcb2gcodeisolation}
\end{figure}

\begin{figure}[ht!]
\centering
\includegraphics[width=90mm]{resources/breakout_paste.png}
\caption{Solder paste output from pcb2gcode, showing where paste is to be deposited.}
\label{pcb2gcodepaste}
\end{figure}

\subsubsection{Adding solder paste support}
Solder paste information is contained in the GTP (Gerber top paste) file. It was decided to extend pcb2gcode to read this file, and output GCODE suitable for solder paste extrusion.

The GTP file is in the same RS-274X extended Gerber format as the other files that pcb2gcode can already read. For simplicity, the existing Gerber processing was used.
This is retrieved in \begin{verbatim}NGC_Exporter::export_layer(see ngc_exporter.cpp)\end{verbatim}. The data is stored as a vector of vertices of each pad to be filled with solder paste.

An assumption is currently made that all pads are rectangular, and that the paste can be suitably applied in a single place. This may need to be improved in the future if large areas
of solder paste are required.

Process of determining where to deposit paste:

\begin{enumerate}
	\item	Vertices of pad stored in array.
	\item	Area of pad calculated.
	\item	Center of pad calculated.
	\item	From the area of the pad, the diameter of the needle, and the required paste thickness, the extrusion distance is calculated.
	\item	GCODE is written to extrude paste at the center of the pad.
\end{enumerate}

Retraction:

The belt on the paste extruder is slightly springy. This results in the extruder continuing to extrude a small amount of solder paste after the motor has stopped moving.
This has an adverse effect on board quality. To counter this, the extruder should be retracted slightly to remove all pressure from the syringe. The distance to retract
as well as speed of retraction should be experimentally determined for optimum results. Retraction support has been added to the solder paste output of pcb2gcode.


\section{Machine testing and use}
As the machine operation is complex, a handbook has been produced that
detail the steps needed to operate it. This forms a separate document
which is attached to this report, although an overview of the operating
process is given in figure \ref{tikzoverview}.

\subsection{Operating Steps}

% Define block styles
\tikzstyle{decision} = [diamond, draw, fill=blue!20, 
    text width=4.5em, text badly centered, node distance=3cm, inner sep=0pt]
\tikzstyle{block} = [rectangle, draw, fill=blue!20, 
    text width=14em, text centered, rounded corners, minimum height=3em]
\tikzstyle{line} = [draw, -latex']
\tikzstyle{cloud} = [draw, ellipse,fill=red!20, node distance=7cm,
    minimum height=2em]
    
\begin{tikzpicture}[align=center,node distance = 1.6cm,auto]
\label{tikzoverview}
    % Place nodes
    \node [block] (pcb2gcode) {run pcb2gcode to generate GCODE};
    \node [cloud, left of=pcb2gcode, align=center] (designfiles) {PCB designs exported\\ from design package\\ in GERBER format};
    
    \node [block, below of=pcb2gcode] (isolationinit) {attach spindle, load isolation milling bit, zero};
    \node [block, below of=isolationinit] (isolation) {send routing GCODE to machine};
    \node [block, below of=isolation, fill=orange!70] (isolationcheck) {visually check board for errors};
    
    \node [block, below of=isolationcheck] (drillinit) {load drill bit, zero};
    \node [block, below of=drillinit] (drill) {send drilling GCODE to machine};
    \node [block, below of=drill, fill=orange!70] (drillcheck) {visually check board for errors};
    
    \node [block, below of=drillcheck] (pasteinit) {load paste extruder};
    \node [block, below of=pasteinit] (paste) {send solder paste GCODE to machine};
    \node [block, below of=paste, fill=orange!70] (pastecheck) {visually check board for errors};
    
    \node [block, below of=pastecheck] (vacuuminit) {load vacuum needle};
    \node [block, below of=vacuuminit] (vacuum) {send pick and place GCODE to machine};
    \node [block, below of=vacuum, fill=orange!70] (vacuumcheck) {visually check board for errors};
    
    \node [block, below of=vacuumcheck] (reflow) {Heat board to melt solder paste};
    % Draw edges
    \path [line,dashed] (designfiles) -- (pcb2gcode);
    \path [line] (pcb2gcode) -- (isolationinit);
    \path [line] (isolationinit) -- (isolation);
    \path [line] (isolation) -- (isolationcheck);
    \path [line] (isolationcheck) -- (drillinit);
    \path [line] (drillinit) -- (drill);
    \path [line] (drill) -- (drillcheck);
    \path [line] (drillcheck) -- (pasteinit);
    \path [line] (pasteinit) -- (paste);
    \path [line] (paste) -- (pastecheck);
    \path [line] (pastecheck) -- (vacuuminit);
    \path [line] (vacuuminit) -- (vacuum);
    \path [line] (vacuum) -- (vacuumcheck);

    \path [line] (vacuumcheck) -- (reflow);
 %   \path [line] (isolation) -- (isolationcheck);
 %   \path [line] (isolationcheck) -- (drillinit);

\end{tikzpicture}

%\section{Measuring Accuracy}


%It is important to measure the accuracy of the axes to ensure that they can reach the specified +-0.05mm. This will need to be measured
%at all points on the bed (as the accuracy will worsen when the bed is central due to increased rod deflection.). Of particular concern will be
%the deflection under the load of the isolation routing bit. The solder paste and device placement will not involve any significant force. The 
%drilling will generate a force, but the tolerance required of a 1mm hole is not nearly as demanding as that of the isolation routing cutter.
%The exact forces exerted by the routing bit have yet to be measured, but are estimated to be 5-10N. This means that the anti-backlash nut
%will need to exert the same or greater force to ensure that the board does not move. This in turn places extra resistance on the motor movement.

\subsection{Testing methodology}

\begin{figure}[ht!]
\centering
\includegraphics[width=90mm]{resources/dial.jpg}
\caption{Measurement setup using a dial gauge to check accuracy.}
\label{dialgauge}
\end{figure}

In order to characterise the accuracy of the machine, it is important to have a consistent measuring regime. A dial gauge is used to measure
relative positions of the axes. See Figure ~\ref{dialgauge} for the experimental setup. It is important to ensure the worst-case error is acceptable. The causes of error and their effects are:

\begin{figure}[ht!]
\centering
\includegraphics[width=100mm]{resources/errors.png}
\caption{Measurement setup, showing error notation.}
\label{errornotation}
\end{figure}

Effects are shown with reference to Figure ~\ref{errornotation}, noting that the X and Y referred to in the figure do not necessarily represent the machine axes.
\begin{itemize} \itemsep0em
	\item	Z displacement: It is possible the surface of the bed will move in the vertical direction, something that should not happen ideally. This 
			will occur if the surface over which the idler bearing runs is not flat, or due to manufacturing tolerances in the linear slides.
	\item	Rotation: The drawer slides do not eliminate rotation completely, and this error dominates. Rotation is relative to the small ball bearing array which slides along
			the drawer slides, so this source of error depends on the absolute slide position. Figure ~\ref{errornotation} shows the largest error possible, with the ball bearings
			far away from the location of maximum error, where rotation effects dominate.
	\item	Motion parallel to the axis direction. This error is mostly caused by flex in the stepper motor mounts, the motor-\textgreater threaded rod couplers and the anti-backlash nuts.
	\item	Motion perpendicular to the axis direction. This error is caused by small amounts of slop in the drawer slides.
\end{itemize}

As it is only important to measure the worst-case error, the point shown in purple in Figure ~\ref{errornotation} is the only point which will be measured. 

In figure \ref{visualtest}, a TQFP-32 SMD was moved in 0.6mm increments, a distance
equivalent to the device's pitch. A USB microscope was fixed to the machine,
and pictures taken at each point. A cross-hair overlay way added in the same
position to each image. As shown, the centre of the cross-hairs all line
up perfectly with the centre of each pin. This was a successful visual test.

\begin{figure}[ht!]
\centering
\includegraphics[width=170mm]{resources/registration.png}
\caption{Visual alignment test using one side of a TQFP-32 Atmega328.}
\label{visualtest}
\end{figure}

\subsection{Machine Performance}
The greatest challenge has been to ensure that the machine's operation is reliable.
All machine subsystems operate correctly, but for convenient operation
user interaction must be minimised. 

\subsubsection{Machine axes}
Obtaining the requires $\pm$ 0.05mm accuracy has been mostly achieved. It has
proved hard to eliminate the occasional $\pm$ 0.07mm error. While this is not
ideal, the accuracy appears sufficient for the parts that have been tested.

During the planning stage, linear bearings were considered as a possible
axis slide. These were measured to have a smaller error than the drawer
slides, but the extra cost was not felt to be justified. The error inherent
in the drawer slides however suggest it may have been better to use the 
linear bearings. The machine design is however conducive to replacing
the slides with bearings with little redesign.

\subsubsection{Spindle}
The novel spindle design has proven to perform excellently. It is greatly
superior to the bearing design used in inexpensive rotary tools (eg the Dremel)
that are sometimes used in CNC projects. In the course of the project, the
limitation of the shaft size needing to be 3mm diameter has not proved to
be a hindrance. While outside the scope of this project, it would be
interesting to evaluate the relative performance of the design against
the preloaded single-bearing spindles of desktop CNC mills.

\subsubsection{Isolation Routing}
The machine has proved as capable at PCB milling as the reference CNC
mill used for comparison (A converted Proxxon MF-70 CNC mill). The
inexpensive brushless motor had sufficient power to cut through the copper
at high speed. In a production version of the machine, it is likely that
the cost could be reduced by using a less powerful motor and speed
controller.

\subsubsection{Pick and place}
The pick and place tool has been shown to operate satisfactorily. One
improvement that is suggested would be to introduce a small rubber shroud
for the vacuum nozzle to ensure a tighter seal and hence stronger force.
This should reduce the movement of the part relative to the needle.

\subsubsection{Hot air tool}
The hot air tool has not proved to operate satisfactorily. Various
attempted designs have suffered from overheating of the nichrome wire,
or insufficient heat transfer to the air. This was however an extended
project goal, and it is entirely possible to use a commercial hot air tool
by hand to reflow the parts. It is likely that a future improvement would
be to replace the hand made hot air tool with a commercial product.




%Assuming that x is the required granularity of calibration (the 
%maximum amount of solder paste that will be wasted), and y is the retraction distance, the following example GCODE will carry out this calibration:

%\begin{lstlisting}[frame=single]
%//values in braces {} are to be evaluated on the host
%
%//Start loop here:
%G92 E{y} //Set extruder position in firmware to be y
%G1 E{x+y} //Extrude x amount of paste
%G1 E{y} //Retract
%//if user has not indicated extrusion then loop again
%
%//when the user has indicated extrusion:
%G92 E{y}
%\end{lstlisting}
	 


\section{Conclusions}
The conclusions to this report are split between a conclusion
and evaluation of the project's implementation, and on the use of automation
to aid PCB manufacture and population.

\subsection{Project implementation}
A recurring theme during the project has been that while all of the machine
aims were attainable, it took more time than was expected to improve
the processes to be user-friendly and reliable. In hindsight it may
have been more efficient to use an existing three-axis system for testing,
so that the tool heads could be used and tested at an earlier stage.

\subsection{Evaluation of method of PCB manufacture/population}

\subsubsection{PCB manufacture}


\begin{figure}[ht!]
\centering
\includegraphics[width=70mm]{resources/flake.jpg}
\caption{Closeup of milled PCB, showing copper flaking.}
\label{flake}
\end{figure}


There are limitations inherent in milling PCBs (compared to the more
usual chemical etching) - the process is incredibly sensitive to positional
errors. It proved difficult to reliably manufacture traces of less than 0.03mm
wide. This was also true of the reference PCB mill. Small flakes of milled
copper have a tendency to bridge traces (See figure \ref{flake}), and are difficult to reliably remove.

While the machine is capable of manufacturing boards with undemanding
features, it has not been shown to be better than a wet chemical etch.
This process is relatively inexpensive and does not have the problem of 
copper flakes (which are chemically dissolved).

\subsubsection{Solder paste extrusion}
Solder paste extrusion must be assessed by comparison with the only two
practical alternatives:

\begin{enumerate}
\item
Solder paste mask. This is a more reliable method and does not suffer from
the start/stop extrusion dribble. It is not however feasible to produce
a mask for small runs of boards due to the cost. 

\item
Hand application. This requires a steady hand which may be a problem, for
example in a classroom or learning environment.
\end{enumerate}

The machine performed acceptably during solder paste extrusion. The 
main problem that was seen during paste extrusion was small amounts of "dribble"
when the pressure was not reduced sufficiently quickly at the end of extrusion.
The use of solder paste is relatively forgiving in this aspect however, and
this was primarily an aesthetic problem with traces of solder on the finished
board.

\subsection{Final Conclusions}
The machine's operation has been shown to be generally acceptable. However
the process requires more human intervention and testing than was envisioned.
In its current state the machine shows limited advantages over
more manual methods of PCB manufacture, but given more development time
and testing this is expected to improve dramatically.

The novel spindle design has far surpassed the design expectations, and it
would be worthwhile to characterise its performance in more demanding applications,
however this is outside the scope of the current project.
The steps taken to produce GCODE (e.g. running pcb2gcode) will always need a PC, but once the GCODE has been produced it is possible for the machine to read this from connected storage.

\section{Future Work}
This section contains envisioned improvements to the machine that were not implemented due to time constraints.

\subsection{Automated inspection}
When producing circuit boards there is always a danger of poor solder 
connections or short circuits between pins. These are not difficult issues
to fix, but they are difficult to identify. If they are not spotted
before the circuit board is powered on, such faults are liable to cause
anything from intermittent operation to destruction of one or more
components on the board. It is possible to check for such errors manually
with a magnifying glass or microscope, but it is very time-consuming.

USB microscope are inexpensive (less than \pounds 10) and have sufficient
resolution to spot poor connections. If mounted as a tool on the machine,
it would be possible to slowly scan the microscope around to generate
a very high resolution image of the board. At the very least this may
make checking for errors manually easier by allowing the user to check
the board more comfortably on a large computer screen. More interestingly,
it may be possible to detect short circuits automatically. Both solder 
and copper are highly reflective compared to PCB material (usually FR4 which
is a dark beige). It may well be possible to effectively "subtract" the
GERBER design file from a high resolution image of the board to leave
only undesired solder. 


\subsection{Double-sided boards}
It is common to use double sided PCBs in order to achieve more compact circuits. The machine will not currently have the ability to process such boards, although this would be possible in a later version.

\subsubsection{Challenges}
There are a number of challenges associated with working with dual sided boards:

\begin{enumerate}
	\item	Clamping the PCB to the bed of the machine is more complex with the second side of a double sided board. The components that have
			already been populated will not allow the board to sit flat and level.
	\item	The PCB material is a moderately good conductor of heat. When the second side of the board is heated to melt the solder paste, there
			is a danger that components on the bottom will be loosened and fall off.
	\item	Both sides of the board must be precisely aligned so that any through-holes or vias line up.
	\item	Any vias that are required will add considerable complexity. Commercially they are manufactured in a multi-stage chemical process
			which is not feasible for the hobbyist.
\end{enumerate}

\subsubsection{Envisioned solutions}

\begin{enumerate}
	\item	As isolation routing places the greatest stresses on the board mounts, it is unlikely that the reverse side of the board can be manufactured
			after the first side has been populated with components. Therefore the isolation routing should be carried out on both sides first. Any holes
			through the board should also be drilled, and cutting the board out also (leaving tabs to hold it in place). When this has been done, the
			rest of the manufacturing process can be continued with less secure mounting from the board edges.
	\item	Melting solder on one side of the board while leaving the other side solid will require active cooling of the bottom of the board. Commercially
			components are often glued so that all the solder paste can be reflowed in one process, but the application of adhesive adds a complex extra
			process to the machine which should be avoided.
	\item	Alignment may be achieved by the use of a small USB microscope. The user would be able to see an image of the board, and select datum points (for
			example the center of a pad). Once the board was flipped, the same datum points could be located. From this, a transformation matrix can simply
			be computed and applied to the coordinates of the GCODE.
	\item	A reasonable substitute for vias is to drill a hole through the board, place a short piece of wire into it and solder both sides to the copper.
			It is likely that the only practical way to achieve this is manually once the board has been manufactured. The ability to perform light milling
			operations with the machine could be used to mill the ends of the wire much closer to the surface of the PCB than could be achieved with wire cutters.
			In this way it is likely that thermal vias under components could be achieved (Vias used for the purpose of heatsinking are placed under the thermal
			tab of an SMD component to conduct heat to copper on the reverse side of the board).
\end{enumerate}

\begin{figure}[ht!]
\centering
\includegraphics[width=160mm]{resources/finished.jpg}
\caption{Finished wooden version of the machine.}
\label{fig:finished}
\end{figure}

\newpage
\appendix
\appendixpage
\addappheadtotoc
\section{Servo tester}

\begin{figure}[ht!]
\centering
\includegraphics[width=160mm]{resources/servoexerciser.png}
\caption{Servo tester schematic.}
\label{fig:servotesterschem}
\end{figure}

The ESC used to control the brushless spindle motor is controlled with standard "servo" control. This consists of variable length pulses sent approximately 20ms apart.
The length of pulses corresponds to the position of the servo, or in this case the desired operation speed of the brushless motor. The pulses are specified to be 1-2ms,
which correspond to the minimum and maximum desired speeds.

During testing it because apparent that it would be useful to have manual control of spindle speed. A simple circuit was designed to provide the necessary pulses (See Figure \ref{fig:servotesterschem}).

The circuit works by using one 555 timer to generate a square wave of approximately 50Hz. This triggers a second 555 timer, which operates in monostable mode, with a pulse length
that is dependent on the position of a potentiometer. The 50Hz wave satisfies the condition of pulses that should be sent approximately every 20ms, and the pulses are varied between 1-2ms. The speed controllers
contain a 5V linear regulator which is connected to one pin of the servo connection. This powers the 555 timers so that no other power supply is required for operation. The circuit performed as expected and 
has been useful in project development.

\begin{figure}[ht!]
\centering
\includegraphics[width=90mm]{resources/servotester.jpg}
\caption{Servo tester board (front and back).}
\label{overflow}
\end{figure}

\newpage
\section{Calliper serial output modification}

\begin{figure}[ht!]
\centering
\includegraphics[width=150mm]{resources/callipermod.jpg}
\caption{Modified callipers (Data port highlighted in red).}
\label{overflow}
\end{figure}

During the testing of accuracy it was necessary to take a large number of positional measurements in all directions. 
To speed up this process, an inexpensive pair of callipers was modified to output a serial data stream which could be logged
against the position according to the firmware. Instructions located here: \cite{caliperdata}.

The positional data can be read from four traces on the calliper internal PCB. For convenience, the +V, ground, data and clock lines
were brought out on to four 2.54" pin headers. As the callipers are powered by a 1.5V battery, NPN transistors are used to amplify the signals to 5V. An ATTINY2313
decodes the data stream and converts it to a serial stream, sent via a USB-serial cable to the PC.

\newpage
\section{SMD component types}

A large variety of SMD types and sizes are available. A selection is described here (from \cite{smdwiki})

\subsection{Two-terminal passive components (mostly resistors and capacitors)}
Package types are given a four digit code, which describes the length and width in mm.

Example:

0603 is a 0.6 x 0.3mm rectangular package.

\subsection{SOT: Small-Outline Transistor}
Despite the name, these devices are not limited to single transistors, other types (eg linear regulators) are
common in the same packages.

Example:

SOT-223 is a 6.7x3.7x1.8mm body, three terminals plus a heat transfer pad.

\subsection{SOIC: Small-Outline Integrated Circuit}
Dual-in-line devices with 8 or more gull-wing lead form pins, spacing of 1.27mm

\newpage

\section{Heater Calculations}
\label{heatcalc}
Assumptions:
\begin{itemize} \itemsep0em
	\item Specific heat capacity of dry air is not significantly affected by temperature for estimates of power required.
	\item 50\% of energy into heater is used to heat hot air stream (other radiative losses)
	\item Flow rate of air pump = 18 cm\textsuperscript{3} / s
	\item Specific heat capacity of dry air = 1.006 J/gK. This is assumed to not change significantly with temperature (acceptable to $\pm$ 10\%).
	\item Room temperature of 20\textsuperscript{0}C, temperature required is 240\textsuperscript{0}C. Delta T = 220K
	\item Density of air = 0.001225 g / cm\textsuperscript{3}
\end{itemize}

Power required to heat air (ideal) = (18*0.001225)*220*1.006 = 4.88W
Power required to heat air (assuming losses) = 4.88*2 = 9.76W

For simplicity, it is assumed that the heater requires 10W of input power.

The design is based on a small coil of nichrome resistance wire as a heating element. Calculations must be made to find
the size of wire required:

Size of coil (Chosen to be similar in diameter to the air tube with 6mm OD/4mm ID)

Diameter = 5mm
Length = 12mm
Wire spacing = 2mm
Angle of wire = tan\textsuperscript{-1} (2/(5* pi )) = 7.26 \textsuperscript{0}
Turns of wire = 12/2 + 1 = 7
Length of wire = 7 * sqrt ((5 * pi )\textsuperscript{2}  * 2\textsuperscript{2}) =  110.84mm

Resistivity of nichrome at room temperature = 1.0 * 10E-6 ohm m 
Power supply voltage = 12V
Current draw = 10 / 12 = 0.83 A 
Resistance required = 12\textsuperscript{2} / 10 = 14.4 ohms
Cross sectional area of wire = 1.0 * 10\textsuperscript{-6} * 110.84 * 10\textsuperscript{-3} / 14.4 = 7.70 * 10\textsuperscript{-9} m\textsuperscript{2} = 7.70 * 10\textsuperscript{-3} mm\textsuperscript{2}
Diameter of wire = sqrt(7.70E-3/pi) * 2 = 0.099mm

This is the minimum diameter of wire. Next the maximum diameter of wire is calculated, assuming a maximum current draw of 10A.

Resistance required = 12 / 10 = 1.2 ohms
Cross sectional area of wire = 7.70 * 10\textsuperscript{-3} * (14.4/1.2) = 0.092 mm \textsuperscript{2}
Diameter of wire = sqrt(0.092/pi) * 2 = 0.34mm

Therefore wire diameter is between 0.099mm and 0.34mm
The most commonly available suitable wire is sold as 30 SWG, equivalent to 0.315mm diameter.

Resistance of 110.84mm of 0.315mm diameter nichrome wire:

\begin{displaymath}
\text{Resistance} = \frac{\rho L}{A}
= \frac{1.0*10^-6*110.84*10^-3}{\pi*(\frac{0.315*10^-3}{2})^2}
= 1.42 \Omega
\end{displaymath}



\begin{displaymath}
\text{Maximum current draw} = \frac{\text{V}}{\text{R}}
= \frac{12}{1.42}
= 8.45 \text{A}
\end{displaymath}

\newpage
\section{Part List}

Auto-generated from "Part List.xlsx" using \cite{excel2latex}.

\begin{tabular}{ | l | l | l | l | }
\hline
	Part & Number required & Total Cost & Supplier \\ \hline
	base\_board & 1 & - & - \\ \hline
	topboard & 1 & - & - \\ \hline
	bed & 1 & - & - \\ \hline
	zsupport & 2 & - & - \\ \hline
	zpanel & 1 & - & - \\ \hline
	base\_back & 1 & - & - \\ \hline
	base\_sides & 2 & - & - \\ \hline
	base\_bottom & 1 & - & - \\ \hline
	electronics\_tray & 1 & - & - \\ \hline
	drawer slides & 6 & 8 & \  \\ \hline
	m8 threaded rods & 3 & \  & \  \\ \hline
	m8 brass nuts & 6 & \  & \  \\ \hline
	anti-backlash springs & 3 & \  & \  \\ \hline
	electronics board & 1 & 30 & \  \\ \hline
	nema17 motors & 3 & 18 & Zapp Automation \\ \hline
	Vacuum tube & 1 & 1 & \  \\ \hline
	Turnigy plush 30A & 1 & 8 & Hobbyking \\ \hline
	Turnigy 450 3800KV & 1 & 8.56 & Hobbyking \\ \hline
	prop savers & 2 & 1.84 & Hobbyking \\ \hline
	m4 nuts and bolts & 40 & \  & \  \\ \hline
	12v 30A psu & 1 & 23.58 & \  \\ \hline
	nuttrap & 3 & \  & \  \\ \hline
	motorholder & 3 & \  & \  \\ \hline
	pasteextruder & 1 & \  & \  \\ \hline
	needleholder & 1 & \  & \  \\ \hline
	zholder & 1 & \  & \  \\ \hline
	rightangle & 4 & \  & \  \\ \hline
\end{tabular}


\newpage
\section{Risk assessment retrospective}
The risks highlighted in the risk assessment were as follows:

\begin{itemize}\itemsep0em
\item
Electrical: only low voltages used (<=12V)

\item
Hazardous substances: solder paste toxic, ensure hand washing after use

\item
Use of workshop equipment.

\item
Mechanical: minor pinching hazards

\item
Other: hot air for soldering, heated 3d printer extruders.

\end{itemize}

The risk assessment accurately reflected the hazards that were encountered
during the project. All safety precautions were carried out as specified,
and no accidents occurred at any point. If starting the project again, no
changes would be made to the risk assessment.

\newpage
\section{Description of project files}
This appendix details the files that were created during the course
of this project. Files are available online: \cite{solderingmachine}.

\begin{lstlisting}[frame=single]
GCODE/	
	Contains utility GCODE files for zeroing and spindle control.

electronics/
	Contains a number of KiCad projects.
	
microscope/	
	Contains microscope images of machine operation.
	
milling/
	Contains files used to test milling.

parts/
	Contains CAD files for the machine, created using Creo.
	
report/
	Contains the \LaTeX files used to create this report.
	
testboards/
	Contains a number of CAD files for various PCBs.
\end{lstlisting}



\newpage
\printglossaries

\nocite{*}
\printbibliography

\end{document}
